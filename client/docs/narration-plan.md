# 数学之美 - 讲解系统实施计划

## 项目概述

为 45 个数学实验添加 PPT 式语音讲解功能，按难度等级分批实施。

**参考实现**: 傅里叶变换 (`/fourier`) - 已完成

---

## 实验清单（按难度分级）

### 第一批：入门级（小学 6-12岁）- 6 个

| 序号 | 实验 | 路径 | 状态 | 预计行数 | 备注 |
|------|------|------|------|----------|------|
| 1 | 加减乘除可视化 | /basic-arithmetic | ⏳ 待制作 | 30-35 | 最基础，适合作为模板 |
| 2 | 分数可视化 | /fractions | ⏳ 待制作 | 30-35 | 饼图、条形图 |
| 3 | 基础几何图形 | /geometry-shapes | ⏳ 待制作 | 35-40 | 面积周长计算 |
| 4 | 集合论可视化 | /set-theory | ⏳ 待制作 | 30-35 | 韦恩图 |
| 5 | 黄金分割 | /golden-ratio | ⏳ 待制作 | 35-40 | 斐波那契、黄金螺线 |
| 6 | 数论探索 | /number-theory | ⏳ 待制作 | 35-40 | 素数、Collatz |

### 第二批：基础级（初中 12-15岁）- 8 个

| 序号 | 实验 | 路径 | 状态 | 预计行数 | 备注 |
|------|------|------|------|----------|------|
| 7 | 一次函数 | /linear-function | ⏳ 待制作 | 35-40 | 斜率截距 |
| 8 | 二次函数 | /quadratic-function | ⏳ 待制作 | 35-40 | 抛物线 |
| 9 | 勾股定理 | /pythagorean | ⏳ 待制作 | 30-35 | 几何证明 |
| 10 | 三角函数 | /trigonometry | ⏳ 待制作 | 40-45 | 单位圆 |
| 11 | 极坐标图形 | /polar | ⏳ 待制作 | 35-40 | 玫瑰线、心形线 |
| 12 | 概率分布 | /probability | ⏳ 待制作 | 40-45 | 正态、泊松、二项 |
| 13 | 贝塞尔曲线 | /bezier | ⏳ 待制作 | 35-40 | de Casteljau |
| 14 | 蒙特卡洛方法 | /monte-carlo | ⏳ 待制作 | 35-40 | 随机模拟 |

### 第三批：中级（高中 15-18岁）- 12 个

| 序号 | 实验 | 路径 | 状态 | 预计行数 | 备注 |
|------|------|------|------|----------|------|
| 15 | 圆锥曲线 | /conic-sections | ⏳ 待制作 | 40-45 | 椭圆、双曲线 |
| 16 | 微积分可视化 | /calculus | ⏳ 待制作 | 45-50 | 导数、积分 |
| 17 | 泰勒级数 | /taylor | ⏳ 待制作 | 40-45 | 函数逼近 |
| 18 | 复数可视化 | /complex | ⏳ 待制作 | 40-45 | 复平面 |
| 19 | 参数方程 | /parametric | ⏳ 待制作 | 35-40 | 参数曲线 |
| 20 | 向量场 | /vector-field | ⏳ 待制作 | 40-45 | 流线图 |
| 21 | 线性代数 | /linear-algebra | ⏳ 待制作 | 45-50 | 矩阵变换 |
| 22 | 插值方法 | /interpolation | ⏳ 待制作 | 35-40 | 拉格朗日、样条 |
| 23 | 数值积分 | /numerical-integration | ⏳ 待制作 | 35-40 | 梯形、辛普森 |
| 24 | 牛顿法 | /newton-method | ⏳ 待制作 | 35-40 | 求根 |
| 25 | 回归分析 | /regression | ⏳ 待制作 | 40-45 | 线性、多项式 |
| 26 | 中心极限定理 | /clt | ⏳ 待制作 | 35-40 | 统计 |

### 第四批：高级（大学本科）- 12 个

| 序号 | 实验 | 路径 | 状态 | 预计行数 | 备注 |
|------|------|------|------|----------|------|
| 27 | 傅里叶变换 | /fourier | ✅ 已完成 | 42 | 参考实现 |
| 28 | 傅里叶级数 | /fourier-series | ⏳ 待制作 | 40-45 | 级数展开 |
| 29 | 傅里叶绘图 | /fourier-drawing | ⏳ 待制作 | 40-45 | 圆周运动 |
| 30 | 信号处理 | /signal-processing | ⏳ 待制作 | 45-50 | 滤波、频谱 |
| 31 | 常微分方程 | /ode | ⏳ 待制作 | 45-50 | 相图 |
| 32 | 波动方程 | /wave-equation | ⏳ 待制作 | 40-45 | 偏微分 |
| 33 | 热传导方程 | /heat-equation | ⏳ 待制作 | 40-45 | 偏微分 |
| 34 | 优化算法 | /optimization | ⏳ 待制作 | 45-50 | 梯度下降 |
| 35 | 梯度下降 | /gradient-descent | ⏳ 待制作 | 40-45 | 机器学习基础 |
| 36 | 矩阵分解 | /matrix-decomposition | ⏳ 待制作 | 45-50 | SVD、特征值 |
| 37 | 主成分分析 | /pca | ⏳ 待制作 | 45-50 | 降维 |
| 38 | 贝叶斯定理 | /bayes | ⏳ 待制作 | 40-45 | 条件概率 |

### 第五批：专业级（研究生+）- 7 个

| 序号 | 实验 | 路径 | 状态 | 预计行数 | 备注 |
|------|------|------|------|----------|------|
| 39 | 混沌理论 | /chaos | ⏳ 待制作 | 45-50 | 洛伦兹吸引子 |
| 40 | 分形几何 | /fractal | ⏳ 待制作 | 45-50 | 曼德博集 |
| 41 | 随机游走 | /random-walk | ⏳ 待制作 | 40-45 | 布朗运动 |
| 42 | 马尔可夫链 | /markov-chain | ⏳ 待制作 | 45-50 | 状态转移 |
| 43 | 博弈论 | /game-theory | ⏳ 待制作 | 45-50 | 纳什均衡 |
| 44 | 图论 | /graph-theory | ⏳ 待制作 | 45-50 | 最短路径 |

---

## 实施流程

### 每个实验的制作步骤

```
步骤 1: 稿件编写 (30-60 分钟)
├── 分析实验内容和交互功能
├── 编写 7 个标准段落
├── 配置动画触发点
└── 输出: src/narrations/scripts/[experiment].ts

步骤 2: 音频生成 (10-20 分钟)
├── 导出 JSON: pnpm run export-narrations
├── 生成云希音频: pnpm run generate-audio -- --script [experiment]
├── 生成晓晓音频: pnpm run generate-audio -- --script [experiment] --voice xiaoxiao
└── 输出: public/audio/narrations/[experiment]/

步骤 3: 场景配置 (20-40 分钟)
├── 创建场景配置文件
├── 为每行配置对应场景
├── 设置初始状态和交互选项
└── 输出: src/components/NarrationPresenter/[experiment]Scenes.ts

步骤 4: 页面集成 (10-20 分钟)
├── 导入 NarrationPresenter
├── 添加状态和回调
├── 添加"开始讲解"按钮
└── 修改: src/experiments/[experiment]/[Experiment]Experiment.tsx

步骤 5: 质检测试 (15-30 分钟)
├── 稿件检查
├── 场景检查
├── 音频检查
├── 功能测试
└── 输出: 质检报告

步骤 6: 部署上线 (5 分钟)
├── pnpm run build
├── rsync 到服务器
└── 验证线上效果
```

### 单个实验预计耗时

| 阶段 | 耗时 |
|------|------|
| 稿件编写 | 30-60 分钟 |
| 音频生成 | 10-20 分钟 |
| 场景配置 | 20-40 分钟 |
| 页面集成 | 10-20 分钟 |
| 质检测试 | 15-30 分钟 |
| 部署上线 | 5 分钟 |
| **总计** | **1.5-3 小时** |

---

## 批次计划

### 第一批：入门级（6 个）
- **目标**: 建立完整的制作流程，积累经验
- **重点**: 语言简单易懂，适合小学生
- **可复用场景**: 基础图形、数轴、饼图

### 第二批：基础级（8 个）
- **目标**: 扩展场景类型，优化制作效率
- **重点**: 函数图像、几何变换
- **可复用场景**: 坐标系、函数图、单位圆

### 第三批：中级（12 个）
- **目标**: 处理复杂数学概念
- **重点**: 微积分、线性代数
- **可复用场景**: 3D 图形、矩阵变换、向量场

### 第四批：高级（11 个，含已完成的傅里叶）
- **目标**: 专业级内容讲解
- **重点**: 信号处理、微分方程、机器学习
- **可复用场景**: 频谱图、相图、优化轨迹

### 第五批：专业级（7 个）
- **目标**: 研究生级别内容
- **重点**: 混沌、分形、随机过程
- **可复用场景**: 吸引子、分形图、状态图

---

## 场景组件复用计划

### 现有场景组件

| 组件 | 用途 | 可复用于 |
|------|------|----------|
| TitleScene | 标题展示 | 所有实验 |
| WaveformScene | 波形/函数图 | 傅里叶、信号处理、函数类 |
| SpectrumScene | 频谱图 | 傅里叶、信号处理 |
| FormulaScene | 公式展示 | 所有实验 |
| ComparisonScene | 对比展示 | 时域/频域、变换前后 |
| ApplicationScene | 应用场景 | 所有实验 |

### 需要新建的场景组件

| 组件 | 用途 | 适用实验 |
|------|------|----------|
| CoordinateScene | 坐标系图形 | 函数、几何 |
| UnitCircleScene | 单位圆 | 三角函数、复数 |
| MatrixScene | 矩阵变换 | 线性代数、PCA |
| PhaseScene | 相图 | ODE、动力系统 |
| DistributionScene | 概率分布 | 概率、统计 |
| FractalScene | 分形图形 | 分形、混沌 |
| GraphScene | 图论图形 | 图论、马尔可夫 |
| AnimationScene | 通用动画 | 各类动画演示 |

---

## 质检清单模板

```markdown
## [实验名称] 讲解质检报告

### 基本信息
- 实验 ID:
- 难度等级:
- 稿件行数:
- 音频总时长:
- 质检日期:
- 质检人:

### 稿件检查
- [ ] ID 唯一性通过
- [ ] ID 格式正确 (段落ID-序号)
- [ ] 文本长度合理 (15-40字/句)
- [ ] 包含所有标准段落 (intro/concept/formula/parameters/animation/application/summary)
- [ ] 语言适合目标年龄段
- [ ] 无错别字和语法错误
- [ ] 动画配置正确

### 场景检查
- [ ] 每行都有对应场景
- [ ] lineId/sectionId 匹配正确
- [ ] 场景类型选择合适
- [ ] 初始状态参数合理
- [ ] 交互配置适当

### 音频检查
- [ ] 云希(男声)音频完整
- [ ] 晓晓(女声)音频完整
- [ ] 音质清晰无杂音
- [ ] 无截断或异常
- [ ] 时长与文本匹配

### 功能测试
- [ ] 点击"开始讲解"正常进入
- [ ] 播放/暂停功能正常
- [ ] 字幕与音频同步
- [ ] 场景随讲解正确切换
- [ ] 男女声切换正常
- [ ] 播放速度调节正常
- [ ] 上一句/下一句正常
- [ ] 暂停时可交互(如适用)
- [ ] 退出讲解正常
- [ ] 退出后状态重置

### 问题记录
| 问题描述 | 严重程度 | 状态 |
|----------|----------|------|
| | | |

### 结论
- [ ] ✅ 通过，可上线
- [ ] ⚠️ 需修改后复检
- [ ] ❌ 严重问题，需重做
```

---

## 进度跟踪

### 总体进度

| 批次 | 实验数 | 已完成 | 进度 |
|------|--------|--------|------|
| 第一批(入门) | 6 | 0 | 0% |
| 第二批(基础) | 8 | 0 | 0% |
| 第三批(中级) | 12 | 0 | 0% |
| 第四批(高级) | 12 | 1 | 8% |
| 第五批(专业) | 7 | 0 | 0% |
| **总计** | **45** | **1** | **2%** |

### 详细进度

使用以下状态标记：
- ⏳ 待制作
- 📝 稿件编写中
- 🎙️ 音频生成中
- 🎬 场景配置中
- 🔧 页面集成中
- 🔍 质检中
- ✅ 已完成

---

## 命令速查

```bash
# 创建新实验讲解
# 1. 编写稿件
vim src/narrations/scripts/[experiment].ts

# 2. 导出 JSON
pnpm run export-narrations

# 3. 生成音频
pnpm run generate-audio -- --script [experiment]
pnpm run generate-audio -- --script [experiment] --voice xiaoxiao

# 4. 创建场景配置
vim src/components/NarrationPresenter/[experiment]Scenes.ts

# 5. 集成到页面
vim src/experiments/[experiment]/[Experiment]Experiment.tsx

# 6. 本地测试
pnpm run dev

# 7. 构建部署
pnpm run build
rsync -avz --delete dist/ us-lax02:/var/www/mathviz/
```

---

## 版本历史

| 版本 | 日期 | 修改内容 |
|------|------|----------|
| 1.0 | 2026-01-03 | 初始计划，基于傅里叶变换实验 |
